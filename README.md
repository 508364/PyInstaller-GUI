# PyInstaller GUI 打包工具

这是一 个基于 Python 的图形用户界面工具，用于快速使用 PyInstaller 打包 Python 脚本.通过直观的界面配置常用打包选项，无需记忆复杂的命令行参数.

## 功能特性

- 简单易用：直观的图形界面，无需命令行知识.
- 常用选项：
  - 支持单文件打包(-F)和目录打包(-D).
  - 控制台窗口设置(显示控制台或无控制台).
  - 设置可执行文件图标(-i).
  - 自定义输出目录(--distpath).
  - 自定义输出文件名(-n，选择主脚本时会自动更新为脚本文件名).
- 附加资源管理(统一入口)：
  - 可直接添加文件或目录.
  - 默认放置规则：目录会作为“同名文件夹”放入运行时临时根目录；文件会直接放入临时根目录(保留原文件名).
  - 支持自定义目标路径：使用“源路径|目标路径”或“源路径＝>目标路径”的形式.
- 实时日志：构建过程中实时输出；点击开始后自动切换到“日志”页；构建成功后自动打开输出目录.
- 清理功能：一键清除构建残留(build 目录， spec 文件， _ _pycache_ _ 等).
- UPX 支持(可调级别)：
  - 提供 1～10 的压缩级别滑块(10 按 9 处理).
  - 采用构建后独立 UPX 压缩，避免与 PyInstaller 内置 UPX 冲突(构建命令固定启用 --noupx).
  - 自动检测／安装 UPX，不可用时自动跳过并在日志提示.
  - 支持配置 UPX 排除列表(按文件名或通配符跳过特定文件).
- 兼容性调整：
  - 自动检测本机 PyInstaller 版本；在 Windows 且 PyInstaller ＜ 6.0 时才显示并启用 WinSxS 相关选项(v6+ 已移除).
  - 移除独立的 --noarchive 复选框；“调试等级”仍支持 -d noarchive.

## 安装步骤

1. 确保已安装 Python(建议 Python 3.8+).
2. 安装 PyInstaller：
  ```bash
  pip install pyinstaller
  ```
3. 下载本仓库中的工具脚本运行，或使用预编译版本(Windows).

使用预编译版本(Windows)：
- 前往发布页下载预编译可执行文件(.exe).
- 双击运行即可，无需安装 Python 环境.

## 使用方法

运行程序
- 使用 Python 运行：
  ```bash
  python ＜脚本文件名>.py
  ```
- 使用预编译版本：直接双击运行 .exe.

配置打包选项
- 点击“浏览”选择要打包的 Python 脚本(.py).输出名称会自动更新为脚本名(可手动修改).
- 设置输出目录(可选)，默认为当前目录下的 dist.
- 选择打包模式：
  - 单文件模式：生成单个可执行文件(.exe).
  - 目录模式：生成包含可执行文件与依赖的目录.
- 控制台选项：
  - 显示控制台：适用于命令行程序.
  - 无控制台：适用于图形界面程序(如 pygame， PyQt 等).
- 图标：点击“图标”旁的“浏览”选择 .ico 文件(可选).

附加资源
- 直接输入源路径(文件或目录)并点击“添加”：
  - 目录会作为同名文件夹放入运行时临时根目录.
  - 文件会直接放入临时根目录(保留原文件名).
- 自定义目标路径示例：
  - C：\\data\\assets|res
  - images\\logo.png|res\\img
  - 也可使用 “＝>” 分隔，例如 src＝>dest
- 仍可在“额外参数”中手动补充其他 PyInstaller 参数(如更多 --add-data).

UPX 压缩
- 在“UPX 压缩级别”滑块选择 1～10(默认 5， 10 按 9 处理).
- 构建成功后会自动对输出文件进行 UPX 压缩；若未找到 UPX，会尝试安装或在日志中提示跳过.
- 可在“UPX 排除列表”填写需跳过压缩的文件名或通配符(如 *.dll).

开始打包
- 点击“开始打包”，界面会自动切换到“日志”页显示实时输出.
- 构建完成后，日志中会提示并尝试打开输出目录.

清理项目
- 点击“清理项目”可删除 build， spec， 及 _ _pycache_ _ 等临时构建产物.

## 注意事项

- 构建耗时取决于项目规模与依赖情况；单文件模式启动时间较长(需要解压到临时目录).
- 确保附加资源的路径正确；自定义资源目标路径请使用“|”或“＝>”分隔.
- Windows 下 WinSxS 相关选项仅在 PyInstaller ＜ 6.0 环境可见；v6+ 已不再支持.

## 常见问题

为什么打包后的程序很大？
- PyInstaller 会将 Python 解释器和依赖库一并打包，这是正常现象.可尝试：
  - 使用 UPX 压缩(本工具默认启用，且可调整压缩级别).
  - 精简依赖，避免引入不必要的大型库.
  - 在虚拟环境中打包，减少无关库被带入.

打包后的程序在其他电脑上无法运行？
- 可能缺少必要运行时(如 VC++ 运行库).可尝试：
  - 安装 Microsoft Visual C++ Redistributable.
  - 若缺少特定文件，可使用 --add-data 进行补充.

程序被杀毒软件误报？
- 由于打包机制，有时会被误报.可尝试：
  - 向杀毒软件厂商提交误报.
  - 对可执行文件进行代码签名(需要数字证书).

支持的操作系统？
- 主要在 Windows 上开发和测试，核心功能应支持跨平台(macOS／Linux).欢迎反馈其他平台使用情况.
